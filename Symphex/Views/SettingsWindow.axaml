<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Symphex.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="650"
        x:Class="Symphex.Views.SettingsWindow"
        x:DataType="vm:SettingsViewModel"
        Icon="/Assets/SymphexLogo.ico"
        Title="Settings - Music Downloader"
        Background="#000000"
        CanResize="false"
        WindowStartupLocation="CenterOwner">

	<Design.DataContext>
		<vm:SettingsViewModel/>
	</Design.DataContext>

	<Window.Styles>
		<Style Selector="Button.primary">
			<Setter Property="Background" Value="#1e40af"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="CornerRadius" Value="8"/>
			<Setter Property="Padding" Value="16,10"/>
			<Setter Property="FontWeight" Value="Bold"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="Cursor" Value="Hand"/>
		</Style>
		<Style Selector="Button.primary:pointerover">
			<Setter Property="Background" Value="#1d4ed8"/>
		</Style>

		<Style Selector="Button.secondary">
			<Setter Property="Background" Value="#1a1a1a"/>
			<Setter Property="Foreground" Value="#ffffff"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BorderBrush" Value="#404040"/>
			<Setter Property="CornerRadius" Value="8"/>
			<Setter Property="Padding" Value="16,10"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="Medium"/>
			<Setter Property="Cursor" Value="Hand"/>
		</Style>
		<Style Selector="Button.secondary:pointerover">
			<Setter Property="Background" Value="#2a2a2a"/>
			<Setter Property="BorderBrush" Value="#606060"/>
		</Style>

		<Style Selector="Border.section">
			<Setter Property="Background" Value="#111111"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="Effect">
				<DropShadowEffect Color="Black" Opacity="0.3" BlurRadius="10" OffsetX="0" OffsetY="2"/>
			</Setter>
		</Style>

		<Style Selector="ProgressBar">
			<Setter Property="Background" Value="#1a1a1a"/>
			<Setter Property="Foreground" Value="#3b82f6"/>
			<Setter Property="CornerRadius" Value="4"/>
			<Setter Property="Height" Value="8"/>
		</Style>
	</Window.Styles>

	<Grid Margin="30">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="20"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="20"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<!-- Header -->
		<StackPanel Grid.Row="0" Spacing="8" HorizontalAlignment="Center">
			<Border Width="50" Height="50" CornerRadius="15" HorizontalAlignment="Center">
				<Border.Background>
					<LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
						<GradientStop Color="#3b82f6" Offset="0"/>
						<GradientStop Color="#2563eb" Offset="1"/>
					</LinearGradientBrush>
				</Border.Background>
				<TextBlock Text="âš™ï¸" FontSize="20" Foreground="White"
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
			</Border>
			<TextBlock Text="Settings" FontSize="20" FontWeight="Bold"
                       Foreground="#ffffff" HorizontalAlignment="Center"/>
		</StackPanel>

		<!-- Settings Content -->
		<Border Grid.Row="2" Classes="section">
			<ScrollViewer VerticalScrollBarVisibility="Auto">
				<StackPanel Spacing="20">
					<!-- Download Settings Section -->
					<StackPanel Spacing="16">
						<TextBlock Text="Download Settings" FontSize="18" FontWeight="Bold" Foreground="#ffffff"/>

						<!-- Artwork Quality (affects both album art and thumbnails) -->
						<Border Background="#1a1a1a" CornerRadius="10" Padding="20">
							<StackPanel Spacing="14">
								<TextBlock Text="ðŸŽ¨ Artwork Quality"
										   FontSize="15"
										   FontWeight="SemiBold"
										   Foreground="#ffffff"/>

								<TextBlock Text="Choose the size for all embedded artwork (album art and thumbnails)"
										   FontSize="13"
										   Foreground="#999999"
										   TextWrapping="Wrap"
										   Margin="0,0,0,8"/>

								<ComboBox SelectedItem="{Binding SelectedThumbnailSize}"
										  ItemsSource="{Binding ThumbnailSizeOptions}"
										  MinWidth="320"
										  HorizontalAlignment="Left"
										  FontSize="14">
									<ComboBox.Styles>
										<Style Selector="ComboBox">
											<Setter Property="Background" Value="#0a0a0a"/>
											<Setter Property="Foreground" Value="#ffffff"/>
											<Setter Property="BorderBrush" Value="#404040"/>
											<Setter Property="CornerRadius" Value="8"/>
											<Setter Property="Padding" Value="14,10"/>
										</Style>
									</ComboBox.Styles>
								</ComboBox>

								<StackPanel Spacing="6" Margin="0,6,0,0">
									<TextBlock Text="ðŸ’¡ Maximum: Best available quality (usually 1200x1200+)"
											   FontSize="12"
											   Foreground="#777777"
											   TextWrapping="Wrap"/>
									<TextBlock Text="âš™ï¸ Medium (600x600): Recommended for compatibility"
											   FontSize="12"
											   Foreground="#777777"
											   TextWrapping="Wrap"/>
									<TextBlock Text="âš¡ Low (300x300): Smallest file size"
											   FontSize="12"
											   Foreground="#777777"
											   TextWrapping="Wrap"/>
								</StackPanel>
							</StackPanel>
						</Border>

						<!-- Album Art Toggle -->
						<Border Background="#1a1a1a" CornerRadius="10" Padding="20">
							<StackPanel Spacing="12">
								<CheckBox IsChecked="{Binding EnableAlbumArtDownload}"
										  FontSize="15"
										  Foreground="#ffffff">
									<TextBlock Text="Download high-quality album artwork"
											   FontWeight="SemiBold"
											   Foreground="#ffffff"/>
								</CheckBox>

								<StackPanel Spacing="8" Margin="32,4,0,0">
									<TextBlock Text="ðŸŽ¨ Searches iTunes, Deezer, and MusicBrainz for official cover art"
											   FontSize="13"
											   Foreground="#999999"
											   TextWrapping="Wrap"/>
									<TextBlock Text="âš¡ Disabling speeds up downloads significantly"
											   FontSize="13"
											   Foreground="#999999"
											   TextWrapping="Wrap"/>
								</StackPanel>
							</StackPanel>
						</Border>

						<!-- Thumbnail Settings -->
						<Border Background="#1a1a1a" CornerRadius="10" Padding="20">
							<StackPanel Spacing="14">
								<TextBlock Text="ðŸ“¸ Video Thumbnail Fallback"
										   FontSize="15"
										   FontWeight="SemiBold"
										   Foreground="#ffffff"/>

								<TextBlock Text="Use video thumbnails when album art is not found or disabled"
										   FontSize="13"
										   Foreground="#999999"
										   TextWrapping="Wrap"/>

								<!-- Download Thumbnail Checkbox -->
								<CheckBox IsChecked="{Binding SkipThumbnailDownload}"
										  FontSize="14"
										  Foreground="#ffffff">
									<TextBlock Text="Download video thumbnails as fallback"
											   Foreground="#ffffff"/>
								</CheckBox>

								<TextBlock Text="âš ï¸ Uncheck to skip all thumbnails (fastest, but no pictures if album art fails)"
										   FontSize="12"
										   Foreground="#999999"
										   Margin="32,0,0,4"
										   TextWrapping="Wrap"/>
							</StackPanel>
						</Border>

						<!-- Artwork Selection Feature -->
						<Border Background="#1a1a1a" CornerRadius="10" Padding="20">
							<StackPanel Spacing="14">
								<TextBlock Text="ðŸ–¼ï¸ Manual Artwork Selection"
										   FontSize="15"
										   FontWeight="SemiBold"
										   Foreground="#ffffff"/>

								<CheckBox IsChecked="{Binding EnableArtworkSelection}"
										  FontSize="14"
										  Foreground="#ffffff">
									<TextBlock Text="Let me choose artwork before download"
											   Foreground="#ffffff"/>
								</CheckBox>

								<StackPanel Spacing="8" Margin="32,4,0,0">
									<TextBlock Text="âœ¨ Shows 4 artwork options to choose from"
											   FontSize="13"
											   Foreground="#999999"
											   TextWrapping="Wrap"/>
									<TextBlock Text="â±ï¸ Auto-selects default after 5 seconds if no choice made"
											   FontSize="13"
											   Foreground="#999999"
											   TextWrapping="Wrap"/>
									<TextBlock Text="ðŸŽ¯ Click on your preferred artwork to select it"
											   FontSize="13"
											   Foreground="#999999"
											   TextWrapping="Wrap"/>
								</StackPanel>
							</StackPanel>
						</Border>

						<!-- Warning when album art disabled but thumbnails enabled -->
						<Border Background="#8B4513" CornerRadius="10" Padding="16"
								IsVisible="{Binding ShowAlbumArtDisabledWarning}">
							<StackPanel Orientation="Horizontal" Spacing="12">
								<TextBlock Text="âš ï¸" FontSize="20" VerticalAlignment="Center"/>
								<StackPanel>
									<TextBlock Text="No Album Art Enabled"
											   FontSize="14"
											   FontWeight="Bold"
											   Foreground="White"/>
									<TextBlock Text="Only video thumbnails will be used (lower quality)"
											   FontSize="12"
											   Foreground="#FFE4B5"
											   TextWrapping="Wrap"/>
								</StackPanel>
							</StackPanel>
						</Border>

						<!-- Warning when everything disabled -->
						<Border Background="#DC143C" CornerRadius="10" Padding="16"
								IsVisible="{Binding ShowNoArtworkWarning}">
							<StackPanel Orientation="Horizontal" Spacing="12">
								<TextBlock Text="ðŸš«" FontSize="20" VerticalAlignment="Center"/>
								<StackPanel>
									<TextBlock Text="No Artwork Will Be Downloaded"
											   FontSize="14"
											   FontWeight="Bold"
											   Foreground="White"/>
									<TextBlock Text="Both album art and thumbnails are disabled. Files will have no pictures."
											   FontSize="12"
											   Foreground="#FFE4E1"
											   TextWrapping="Wrap"/>
								</StackPanel>
							</StackPanel>
						</Border>
					</StackPanel>

					<!-- Updater Section -->
					<StackPanel Spacing="12">
						<TextBlock Text="Application Updates" FontSize="16" FontWeight="Bold" Foreground="#ffffff"/>

						<StackPanel Spacing="8">
							<TextBlock Text="{Binding CurrentVersionText}" FontSize="13" Foreground="#cccccc" HorizontalAlignment="Center"/>
							<TextBlock Text="{Binding UpdateStatusText}" FontSize="12" Foreground="#999999" HorizontalAlignment="Center" TextWrapping="Wrap"/>

							<Button Content="Check for Updates"
									Command="{Binding CheckForUpdatesCommand}"
									Classes="secondary"
									IsEnabled="{Binding !IsCheckingForUpdates}"
									HorizontalAlignment="Center"
									Margin="0,8,0,0"/>
						</StackPanel>

						<!-- Update Progress -->
						<StackPanel Spacing="8" IsVisible="{Binding IsCheckingForUpdates}">
							<TextBlock Text="Checking for updates..." FontSize="12" Foreground="#999999"/>
							<ProgressBar IsIndeterminate="True"/>
						</StackPanel>

						<!-- Update Available -->
						<Border Background="#10b981" CornerRadius="8" Padding="16" IsVisible="{Binding IsUpdateAvailable}">
							<StackPanel Spacing="12">
								<StackPanel Spacing="4" HorizontalAlignment="Center">
									<TextBlock Text="ðŸŽ‰ Update Available!" FontSize="14" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
									<TextBlock Text="{Binding LatestVersionText}" FontSize="12" Foreground="#e6fffa" HorizontalAlignment="Center"/>
								</StackPanel>

								<Button Content="ðŸš€ Download and Install Update"
										Command="{Binding UpdateCommand}"
										Classes="primary"
										HorizontalAlignment="Center"
										IsEnabled="{Binding !IsUpdating}"
										Background="White"
										Foreground="#10b981"
										FontWeight="Bold"/>
							</StackPanel>
						</Border>

						<!-- Update Progress -->
						<StackPanel Spacing="8" IsVisible="{Binding IsUpdating}">
							<TextBlock Text="{Binding UpdateProgressText}" FontSize="12" Foreground="#999999"/>
							<ProgressBar Value="{Binding UpdateProgress}" Maximum="100"/>
						</StackPanel>
					</StackPanel>
				</StackPanel>
			</ScrollViewer>
		</Border>

		<!-- Footer -->
		<StackPanel Grid.Row="4" Orientation="Horizontal" Spacing="12" HorizontalAlignment="Right">
			<Button Content="Close" Command="{Binding CloseCommand}" Classes="secondary"/>
		</StackPanel>
	</Grid>
</Window>